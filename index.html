<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Your Booth Profile - CSC Conference</title>
    <link rel="stylesheet" href="https://use.typekit.net/ilr6ctr.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'davis-sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            padding: 3vh 3vw;
        }

        /* Background image - right side only in landscape */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            right: 0;
            width: 20%;
            height: 100%;
            background: url('https://images.squarespace-cdn.com/content/v1/5cf7db4cc0827b0001c9ff81/b115546f-0ea2-4efc-8401-79d0991119ce/Background+art.png?format=2500w') no-repeat right center;
            background-size: cover;
            z-index: -1;
        }

        /* DESKTOP: Container */
        .wizard-container {
            display: flex;
            width: 100%;
            height: calc(100vh - 6vh);
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.66);
            border-radius: 20px;
            border: 3px solid #000000;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        /* Sidebar */
        .sidebar {
            width: 23vw;
            height: 100%;
            background: #e6e6e6;
            padding: 50px 40px;
            display: flex;
            flex-direction: column;
            box-shadow: 6px 0 16px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 2;
        }

        .logo-section {
            margin-bottom: 6vw;
            width: 100%;
        }

        .logo-and-title {
            display: flex;
            align-items: flex-start;
            gap: 1vw;
            height: 5vw;
            margin-bottom: 2vw;
        }

        .logo {
            width: 5vw;
            height: 5vw;
            flex-shrink: 1;
        }

        .logo-text {
            flex: 1;
            height: 5vw;
            display: flex;
            flex-direction: column;
            justify-content: left;
        }

        .booth-section {
            width: 100%;
            margin-left: 4.9vw;
        }

        .conference-title {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 1.6vw;
            color: #000000;
            line-height: 1.15;
            margin: 0;
        }

        .booth-number {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 2.1vw;
            color: #000000;
            margin: 0;
            line-height: 1;
        }

        /* Step Navigation */
        .step-navigation {
            flex: 1;
        }

        .step-item {
            display: flex;
            align-items: center;
            margin-bottom: 2vw;
            padding: 0.8vw 0;
        }

        .step-number {
            width: 2vw;
            height: 2vw;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1.2vw;
            flex-shrink: 0;
        }

        .step-number svg {
            width: 1.4vw;
            height: 1.4vw;
        }

        .step-title {
            font-weight: 500;
            font-size: 1.2vw;
            color: #333333;
            line-height: 1.2;
        }

        /* Active step styling */
        .step-item.active .step-number svg {
            fill: #0071bc !important;
        }

        .step-item.active .step-title {
            color: #0071bc;
            font-weight: 700;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 0px 60px 80px 5%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            position: relative;
            min-height: 400px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }

        /* Welcome Screen */
        .welcome-section {
            width: 50%;
            max-width: none;
            margin-top: 140px;
        }

        .welcome-title {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 3.0vw;
            color: #000000;
            margin-bottom: 30px;
            line-height: 1.1;
        }

        .welcome-text {
            font-family: 'davis-sans', sans-serif;
            font-weight: 400;
            font-size: 1.0vw;
            color: #808080;
            line-height: 1.6;
            margin-bottom: 24px;
        }

        /* Step Content Styles */
        .step-header {
            margin-bottom: 40px;
            margin-top: 60px;
        }

        .step-title-main {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 3.0vw;
            color: #000000;
            margin-bottom: 15px;
            line-height: 1.1;
        }

        .step-subtitle {
            font-family: 'davis-sans', sans-serif;
            font-weight: 400;
            font-size: 1.0vw;
            color: #808080;
            line-height: 1.4;
            margin: 0;
        }

        /* Form Styles - Remove Width Constraints */
        .form-container {
            max-width: none; /* Remove the constraint! */
            width: 100%;
        }

        .form-field {
            margin-bottom: 1.5vw;
            position: relative;
            width: 100%;
        }

        /* Company Name - Large Bold Display */
        .form-field:first-child .field-display {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 1.8vw;
            color: #000000;
            line-height: 1.2;
            display: inline-block;
        }

        .form-field:first-child .edit-btn {
            display: inline-flex;
            margin-left: 0.8vw;
            vertical-align: middle;
        }

        /* Website - Smaller, lighter */
        .form-field:nth-child(2) .field-display {
            font-family: 'davis-sans', sans-serif;
            font-weight: 400;
            font-size: 1.0vw;
            color: #666666;
            line-height: 1.2;
            display: inline-block;
        }

        .form-field:nth-child(2) .edit-btn {
            display: inline-flex;
            margin-left: 0.8vw;
            vertical-align: middle;
        }

        /* Category - Normal text */
        .form-field:nth-child(3) .field-display {
            font-family: 'davis-sans', sans-serif;
            font-weight: 400;
            font-size: 1.2vw;
            color: #333333;
            line-height: 1.2;
            display: inline-block;
        }

        .form-field:nth-child(3) .edit-btn {
            display: inline-flex;
            margin-left: 0.8vw;
            vertical-align: middle;
        }

        /* Description - Paragraph text with inline edit button */
        .form-field:nth-child(4) .field-display {
            font-family: 'davis-sans', sans-serif;
            font-weight: 400;
            font-size: 1.0vw;
            color: #666666;
            line-height: 1.5;
            display: inline-block;
            margin-right: 0.8vw;
            vertical-align: middle;
        }

        .form-field:nth-child(4) .edit-btn {
            display: inline-flex;
            vertical-align: middle;
        }

        .edit-btn {
            background: none;
            border: none;
            color: #999999;
            cursor: pointer;
            padding: 0.2vw;
            align-items: center;
            justify-content: center;
            border-radius: 0.2vw;
            transition: all 0.2s ease;
            width: 1.2vw;
            height: 1.2vw;
        }

        .edit-btn svg {
            width: 1vw;
            height: 1vw;
        }

        .edit-btn:hover {
            color: #666666;
        }

        .field-display.placeholder {
            color: #999999;
            font-style: italic;
        }

        /* ===========================================
           ANIMATED FIELD SYSTEM
           =========================================== */

        /* Field Overlay System */
        .field-overlay {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 10;
        }

        .field-overlay.active {
            pointer-events: all;
        }

        /* Border with Simple Single Sweep */
        .field-border {
            position: absolute;
            border: 2px solid transparent;
            border-radius: 8px;
            background: transparent;
            pointer-events: none;
            position: relative;
        }

        .field-border::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border: 2px solid #0071bc;
            border-radius: 8px;
            
            /* Simple single sweep from left to right */
            clip-path: inset(0 100% 0 0);
            animation: drawBorderSweep 0.3s ease-out forwards;
        }

        @keyframes drawBorderSweep {
            from { clip-path: inset(0 100% 0 0); }    /* Hidden */
            to { clip-path: inset(0 0 0 0); }         /* Fully visible */
        }

        /* Simple Label - No Animation */
        .field-label {
            position: absolute;
            font-family: 'davis-sans', sans-serif;
            font-weight: 600;
            font-size: 0.9vw;
            color: #0071bc;
            background: #ffffff;
            padding: 0 0.4vw;
            white-space: nowrap;
        }

        .field-label.animate-in {
            opacity: 1;
            transform: translateY(0);
        }

        /* Input Field Positioning - 38vw Width */
        .field-input-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 38vw; /* Match mockup proportions */
        }

        .field-input, .field-select, .field-textarea {
            border: none;
            outline: none;
            background: transparent;
            font-family: 'davis-sans', sans-serif;
            color: #000000;
            padding: 0;
            margin: 0;
            width: 100%;
            resize: none;
        }

        /* Match font styles to display elements */
        .field-input.company-name {
            font-weight: 700;
            font-size: 1.8vw;
            line-height: 1.2;
        }

        .field-input.website {
            font-weight: 400;
            font-size: 1.0vw;
            line-height: 1.2;
        }

        /* Category Select - 38vw Width */
        .category-dropdown {
            position: relative;
            width: 38vw; /* Match mockup proportions */
        }

        .category-select {
            width: 100%;
            padding: 12px 40px 12px 16px;
            border: 2px solid #cccccc;
            border-radius: 8px;
            font-family: 'davis-sans', sans-serif;
            font-weight: 400;
            font-size: 1.2vw; /* Same as category display */
            line-height: 1.2; /* Same as category display */
            color: #333333;
            background: #ffffff;
            cursor: pointer;
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            transition: border-color 0.2s ease;
        }

        .category-select:hover {
            border-color: #999999;
        }

        .category-select option:first-child {
            color: #999999;
            font-style: italic;
        }

        .category-dropdown-arrow {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 12px;
            pointer-events: none;
        }

        .field-textarea.description {
            font-weight: 400;
            font-size: 1.0vw;
            line-height: 1.5;
            min-height: 6vw; /* Back to original logic */
        }

        /* Character Counter for Description */
        .character-counter {
            position: absolute;
            bottom: 0.5vw;
            right: 0.8vw;
            font-family: 'davis-sans', sans-serif;
            font-size: 0.7vw;
            color: #999999;
            font-weight: 400;
            background: #ffffff;
            padding: 0.2vw 0.4vw;
            border-radius: 0.2vw;
            transition: all 0.2s ease;
        }

        .character-counter.warning {
            font-weight: 700;
            color: #0071bc;
        }

        /* Button Styles */
        .get-started-btn, .next-btn {
            background: #0071bc;
            color: #ffffff;
            border: none;
            width: max(12.5vw);
            min-width: 160px;
            height: auto;
            padding: max(1vw, 12px) max(1.5vw, 16px);
            border-radius: max(0.5vw, 6px);
            font-size: max(1.0vw, 14px);
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: max(0.5vw, 6px);
            position: absolute;
            right: max(5vw, 50px);
            bottom: max(3.5vw, 35px);
            z-index: 5;
            box-shadow: 6px 0 16px rgba(0, 0, 0, 0.3);
            transition: all 0.2s ease;
        }

        .get-started-btn:hover, .next-btn:hover {
            background: #005a94;
        }

        .previous-btn {
            background: #ffffff;
            color: #666666;
            border: 2px solid #cccccc;
            width: max(12.5vw);
            min-width: 160px;
            height: auto;
            padding: max(1vw, 12px) max(1.5vw, 16px);
            border-radius: max(0.5vw, 6px);
            font-size: max(1.0vw, 14px);
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: max(0.5vw, 6px);
            position: absolute;
            left: 0;
            bottom: max(3.5vw, 35px);
            z-index: 5;
            transition: all 0.2s ease;
        }

        .previous-btn:hover {
            background: #f8f8f8;
            border-color: #999999;
            color: #333333;
        }

        /* Loading State */
        .loading {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
        }

        .loading-title {
            font-family: 'davis-sans', sans-serif;
            font-weight: 700;
            font-size: 48px;
            color: #000000;
            margin-bottom: 20px;
        }

        /* Content fade-in animation */
        .wizard-content {
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            display: flex;
            width: 100%;
            height: 100%;
        }

        .wizard-content.loaded {
            opacity: 1;
        }

        /* Error State */
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 20px;
            border-radius: 8px;
            margin: 20px;
            display: none;
            font-size: 16px;
        }

        /* Success State */
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            margin: 20px;
            display: none;
        }

        .success h3 {
            font-size: 24px;
            margin-bottom: 15px;
        }

        /* Mobile Progress Bar */
        .mobile-progress {
            display: none;
            height: 4px;
            background: #e6e6e6;
            position: relative;
            margin-bottom: 20px;
        }

        .mobile-progress-fill {
            height: 100%;
            background: #0071bc;
            transition: width 0.3s ease;
        }

        /* Responsive breakpoints */
        @media (max-width: 1000px) {
            .welcome-section {
                width: 60%;
            }
        }

        /* MOBILE/TABLET: Complete Layout Change */
        @media (orientation: portrait), (max-width: 768px) {
            body {
                padding: 0;
            }
            
            body::before {
                display: none;
            }
            
            .wizard-container {
                position: static;
                transform: none;
                width: 100%;
                height: auto;
                min-height: 100vh;
                max-width: none;
                margin: 0;
                border-radius: 0;
                border: none;
                flex-direction: column;
                box-shadow: none;
                background: #ffffff;
                display: flex;
            }

            .wizard-content {
                display: flex;
                flex-direction: column;
                width: 100%;
                min-height: 100vh;
            }

            .sidebar {
                width: 100%;
                padding: 20px;
                box-shadow: none;
                border-bottom: 1px solid #cccccc;
                flex-shrink: 0;
                height: auto;
                order: 1;
            }

            .main-content {
                padding: 20px;
                flex: 1;
                order: 2;
                display: flex;
                flex-direction: column;
            }

            .logo-and-title {
                height: auto;
                margin-bottom: 10px;
            }

            .logo {
                width: 40px;
                height: 40px;
            }

            .logo-text {
                height: auto;
            }

            .conference-title {
                font-size: 16px;
                margin-bottom: 5px;
            }

            .booth-section {
                margin-left: 55px;
                margin-top: 10px;
            }

            .booth-number {
                font-size: 20px;
            }

            .step-navigation {
                display: none;
            }

            .mobile-progress {
                display: block;
            }

            .welcome-section {
                width: 100%;
                max-width: none;
                margin-top: 0;
            }

            .welcome-title {
                font-size: 36px;
            }

            .welcome-text {
                font-size: 16px;
            }

            .get-started-btn, .next-btn, .previous-btn {
                position: static;
                transform: none;
                width: 100%;
                max-width: 300px;
                margin-top: 30px;
                font-size: 18px;
                right: auto;
                bottom: auto;
                left: auto;
                z-index: auto;
            }
        }

        @media (max-width: 480px) {
            .welcome-title {
                font-size: 36px;
            }

            .welcome-text {
                font-size: 14px;
            }

            .booth-number {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <div class="wizard-container">
        <!-- Loading State -->
        <div id="loadingState" class="loading">
            <div class="loading-title">Loading...</div>
        </div>

        <!-- Error State -->
        <div id="errorState" class="error">
            <strong>Oops!</strong> <span id="errorMessage"></span>
        </div>

        <!-- Success State -->
        <div id="successState" class="success">
            <h3>‚úÖ Profile Updated Successfully!</h3>
            <p>Thank you for completing your booth profile. Your information is now under review and will appear on the conference map once approved.</p>
        </div>

        <!-- All Content - Hidden until loaded -->
        <div class="wizard-content" id="wizardContent">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="logo-section">
                    <div class="logo-and-title">
                        <img src="https://images.squarespace-cdn.com/content/v1/5cf7db4cc0827b0001c9ff81/3c43cc7d-5f2a-4b5e-888e-887d3bb38ebc/Logo+Only.png?format=750w" alt="Campus Stores Conference" class="logo">
                        <div class="logo-text">
                            <div class="conference-title">CAMPUS STORES<br>CONFERENCE</div>
                        </div>
                    </div>
                    <div class="booth-section">
                        <div class="booth-number" id="boothNumber">Booth 501</div>
                    </div>
                </div>

                <div class="step-navigation">
                    <div class="step-item" data-step="0">
                        <div class="step-number">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28.01 28.01">
                                <path d="M14.01,28.01C6.28,28.01,0,21.73,0,14.01S6.28,0,14.01,0s14.01,6.28,14.01,14.01-6.28,14.01-14.01,14.01ZM14.01,2C7.39,2,2,7.39,2,14.01s5.39,12.01,12.01,12.01,12.01-5.39,12.01-12.01S20.63,2,14.01,2Z"/>
                                <path d="M13.25,22.55v-13.78l-1.63.89-1.06-1.8,4.51-2.4h.38v17.09h-2.21Z"/>
                            </svg>
                        </div>
                        <div class="step-title">Company information</div>
                    </div>
                    <div class="step-item" data-step="1">
                        <div class="step-number">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28.04 28.01">
                                <path d="M13.98,28.01C6.25,28.01-.03,21.73-.03,14.01S6.25,0,13.98,0s14.01,6.28,14.01,14.01-6.28,14.01-14.01,14.01ZM13.98,2C7.36,2,1.97,7.39,1.97,14.01s5.39,12.01,12.01,12.01,12.01-5.39,12.01-12.01S20.6,2,13.98,2Z"/>
                                <path d="M8.94,22.55v-.82l5.21-7.15c1.44-1.97,2.18-3.34,2.18-4.73,0-1.66-1.06-2.47-2.42-2.47-1.46,0-2.47.94-2.47,2.35,0,1.27.84,1.78.84,1.78l-1.7,1.25s-1.44-1.15-1.44-3c0-1.49.96-4.3,4.99-4.3s4.58,2.98,4.58,4.51c0,.79-.12,2.16-2.06,4.8l-4.32,5.9h6.7v1.87h-10.08Z"/>
                            </svg>
                        </div>
                        <div class="step-title">Conference highlight</div>
                    </div>
                    <div class="step-item" data-step="2">
                        <div class="step-number">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28.01 28.25">
                                <path d="M14.01,28.25C6.28,28.25,0,21.97,0,14.25S6.28.24,14.01.24s14.01,6.28,14.01,14.01-6.28,14.01-14.01,14.01ZM14.01,2.24C7.39,2.24,2,7.63,2,14.25s5.39,12.01,12.01,12.01,12.01-5.39,12.01-12.01S20.63,2.24,14.01,2.24Z"/>
                                <path d="M10.36,18.67c.46,1.03,1.46,2.33,3.41,2.33,2.09,0,3.1-1.51,3.1-3.43,0-1.8-.86-3.22-3.41-3.22h-1.32v-1.87h1.37c2.02,0,2.78-.89,2.78-2.47s-.79-2.52-2.35-2.52c-1.39,0-2.23.72-2.86,2.11l-1.73-1.10c.79-1.58,2.14-2.93,4.66-2.93,2.93,0,4.66,1.82,4.66,4.25s-1.63,3.24-2.4,3.48c.65.19,2.98.94,2.98,4.22s-2.45,5.42-5.47,5.42c-2.69,0-4.32-1.63-4.99-3.12l1.58-1.15Z"/>
                            </svg>
                        </div>
                        <div class="step-title">Conference team</div>
                    </div>
                    <div class="step-item" data-step="3">
                        <div class="step-number">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28.01 28.01">
                                <path d="M14.01,28.01C6.28,28.01,0,21.73,0,14.01S6.28,0,14.01,0s14.01,6.28,14.01,14.01-6.28,14.01-14.01,14.01ZM14.01,2C7.39,2,2,7.39,2,14.01s5.39,12.01,12.01,12.01,12.01-5.39,12.01-12.01S20.63,2,14.01,2Z"/>
                                <path d="M15.23,22.31v-5.38h-6.84v-1.15l4.22-10.27h2.35l-3.84,9.55h4.1v-5.62h2.26v5.62h2.23v1.87h-2.23v5.38h-2.26Z"/>
                            </svg>
                        </div>
                        <div class="step-title">Product catalogue</div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <!-- Mobile Progress Bar -->
                <div class="mobile-progress">
                    <div class="mobile-progress-fill" style="width: 0%"></div>
                </div>

                <!-- Welcome Screen -->
                <div id="welcomeSection" class="content-section active">
                    <div class="welcome-section">
                        <h1 class="welcome-title">Welcome</h1>
                        <p class="welcome-text">
                            Thank you for being a valued partner of Campus Stores Canada! To help our conference attendees discover your amazing products and services, we'd love your help completing your booth profile.
                        </p>
                        <p class="welcome-text">
                            You'll be asked to provide <strong>company information</strong>, highlight a <strong>featured product or service</strong>, select your <strong>conference team members</strong>, and optionally upload a <strong>product catalogue</strong>.
                        </p>
                        <p class="welcome-text">
                            Your information will be reviewed by our team before appearing on the conference map. While we're here to help make everything look great, you know your business best, so please share what you think will be most helpful for our members.
                        </p>
                        <p class="welcome-text">
                            We truly appreciate you taking the time to do this - our members are going to love having this information available, and we're excited to showcase your participation at the conference!
                        </p>
                        <button class="get-started-btn" onclick="startWizard()">
                            Get started
                            <span>‚Üí</span>
                        </button>
                    </div>
                </div>

                <!-- Step 1: Company Information -->
                <div id="step1Section" class="content-section">
                    <div class="step-header">
                        <h2 class="step-title-main">Company information</h2>
                        <p class="step-subtitle">Please ensure the following information about your company is accurate:</p>
                    </div>

                    <div class="form-container">
                        <!-- Company Name Field -->
                        <div class="form-field" data-field="companyName">
                            <div class="field-display" id="companyNameDisplay">Loading...</div>
                            <button class="edit-btn" onclick="editField('companyName')" id="editCompanyName">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="m18 2 4 4-14 14H4v-4L18 2z"/>
                                    <path d="m14.5 5.5 4 4"/>
                                </svg>
                            </button>
                        </div>

                        <!-- Website Field -->
                        <div class="form-field" data-field="website">
                            <div class="field-display" id="websiteDisplay">website (example.com)</div>
                            <button class="edit-btn" onclick="editField('website')" id="editWebsite">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="m18 2 4 4-14 14H4v-4L18 2z"/>
                                    <path d="m14.5 5.5 4 4"/>
                                </svg>
                            </button>
                        </div>

                        <!-- Category Field -->
                        <div class="form-field" data-field="category">
                            <div class="category-dropdown">
                                <select class="category-select" id="categorySelect">
                                    <option value="">Select your primary category</option>
                                    <option value="Accessories">Accessories</option>
                                    <option value="Apparel">Apparel</option>
                                    <option value="Books">Books</option>
                                    <option value="Campus Living">Campus Living</option>
                                    <option value="Food & Beverages">Food & Beverages</option>
                                    <option value="Gifts & Promotional Products">Gifts & Promotional Products</option>
                                    <option value="Graduation & Regalia">Graduation & Regalia</option>
                                    <option value="Health & Beauty">Health & Beauty</option>
                                    <option value="School Office & Lab Supplies">School Office & Lab Supplies</option>
                                    <option value="Store Operations">Store Operations</option>
                                    <option value="Technology & Electronics">Technology & Electronics</option>
                                    <option value="Other">Other</option>
                                </select>
                                <svg class="category-dropdown-arrow" viewBox="0 0 19.87 12.22">
                                    <path d="M19.68.11c-.21-.17-.52-.15-.7.07l-9.03,10.77-.02-.02-.02.02L.88.18C.7-.04.39-.06.18.11-.04.29-.06.61.11.82l9.42,11.22c.1.12.24.18.38.18h.04c.14,0,.28-.06.38-.18L19.75.82c.17-.21.15-.53-.07-.71Z" fill="#999999"/>
                                </svg>
                            </div>
                        </div>

                        <!-- Company Description Field -->
                        <div class="form-field" data-field="description">
                            <div class="field-display" id="descriptionDisplay">Give our members an elevator pitch of who you are.</div>
                            <button class="edit-btn" onclick="editField('description')" id="editDescription">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="m18 2 4 4-14 14H4v-4L18 2z"/>
                                    <path d="m14.5 5.5 4 4"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Navigation Buttons -->
                    <button class="previous-btn" onclick="previousStep()" id="prevBtn">
                        <span>‚Üê</span>
                        Previous step
                    </button>
                    <button class="next-btn" onclick="nextStep()" id="nextBtn">
                        Next step
                        <span>‚Üí</span>
                    </button>
                </div>

                <!-- Step 2: Conference Highlight -->
                <div id="step2Section" class="content-section">
                    <h2>Conference Highlight</h2>
                    <!-- Content will be added here -->
                </div>

                <!-- Step 3: Conference Team -->
                <div id="step3Section" class="content-section">
                    <h2>Conference Team</h2>
                    <!-- Content will be added here -->
                </div>

                <!-- Step 4: Product Catalogue -->
                <div id="step4Section" class="content-section">
                    <h2>Product Catalogue</h2>
                    <!-- Content will be added here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===========================================
        // WIZARD STATE MANAGEMENT
        // ===========================================
        let currentStep = 0;
        const totalSteps = 4;
        let vendorData = {};
        let organizationContacts = [];
        let conferenceTeam = [];

        const API_BASE = '/api';

        // ===========================================
        // ANIMATED FIELD SYSTEM
        // ===========================================
        let activeField = null;
        let formState = {
            companyName: '',
            website: '',
            category: '',
            description: ''
        };

        // Field configurations
        const fieldConfigs = {
            companyName: {
                label: 'Company name',
                type: 'input',
                inputClass: 'company-name',
                placeholder: 'Enter company name'
            },
            website: {
                label: 'Website',
                type: 'input',
                inputClass: 'website',
                placeholder: 'example.com'
            },
            category: {
                label: 'Category',
                type: 'select',
                inputClass: 'category',
                options: [
                    { value: '', text: 'Select your primary category' },
                    { value: 'Accessories', text: 'Accessories' },
                    { value: 'Apparel', text: 'Apparel' },
                    { value: 'Books', text: 'Books' },
                    { value: 'Campus Living', text: 'Campus Living' },
                    { value: 'Food & Beverages', text: 'Food & Beverages' },
                    { value: 'Gifts & Promotional Products', text: 'Gifts & Promotional Products' },
                    { value: 'Graduation & Regalia', text: 'Graduation & Regalia' },
                    { value: 'Health & Beauty', text: 'Health & Beauty' },
                    { value: 'School Office & Lab Supplies', text: 'School Office & Lab Supplies' },
                    { value: 'Store Operations', text: 'Store Operations' },
                    { value: 'Technology & Electronics', text: 'Technology & Electronics' },
                    { value: 'Other', text: 'Other' }
                ]
            },
            description: {
                label: 'Company description',
                type: 'textarea',
                inputClass: 'description',
                placeholder: 'Give our members an elevator pitch of who you are.',
                maxLength: 300
            }
        };

        function editField(fieldName) {
            // Close any currently active field first (no animation)
            if (activeField && activeField !== fieldName) {
                closeField(activeField);
            }

            activeField = fieldName;
            const fieldElement = document.querySelector(`[data-field="${fieldName}"]`);
            const displayElement = document.getElementById(`${fieldName}Display`);
            const editButton = document.getElementById(`edit${capitalizeFirst(fieldName)}`);
            
            // Get display element position and dimensions
            const displayRect = displayElement.getBoundingClientRect();
            const fieldRect = fieldElement.getBoundingClientRect();
            
            // Calculate relative position within the field container
            const relativeTop = displayRect.top - fieldRect.top;
            const relativeLeft = displayRect.left - fieldRect.left;
            
            // Hide display and edit button
            displayElement.style.opacity = '0';
            editButton.style.opacity = '0';
            
            // Create overlay system
            createFieldOverlay(fieldName, relativeLeft, relativeTop, displayRect.width, displayRect.height);
            
            console.log('üìù Editing field:', fieldName);
        }

        function closeField(fieldName) {
            // Remove overlay immediately (no animation)
            removeFieldOverlay(fieldName);
            
            // Show display and edit button
            const displayElement = document.getElementById(`${fieldName}Display`);
            const editButton = document.getElementById(`edit${capitalizeFirst(fieldName)}`);
            if (displayElement) displayElement.style.opacity = '1';
            if (editButton) editButton.style.opacity = '1';
        }

        function createFieldOverlay(fieldName, x, y, width, height) {
            const fieldElement = document.querySelector(`[data-field="${fieldName}"]`);
            const config = fieldConfigs[fieldName];
            
            // Create overlay container
            const overlay = document.createElement('div');
            overlay.className = 'field-overlay active';
            overlay.id = `overlay-${fieldName}`;
            
            // Create border
            const border = document.createElement('div');
            border.className = 'field-border';
            
            // Create label
            const label = document.createElement('div');
            label.className = 'field-label';
            label.textContent = config.label;
            
            // Create input container
            const inputContainer = document.createElement('div');
            inputContainer.className = 'field-input-container';
            
            // Create input element
            let inputElement;
            if (config.type === 'select') {
                inputElement = document.createElement('select');
                inputElement.className = `field-select ${config.inputClass}`;
                config.options.forEach(option => {
                    const optionEl = document.createElement('option');
                    optionEl.value = option.value;
                    optionEl.textContent = option.text;
                    inputElement.appendChild(optionEl);
                });
            } else if (config.type === 'textarea') {
                inputElement = document.createElement('textarea');
                inputElement.className = `field-textarea ${config.inputClass}`;
                inputElement.maxLength = config.maxLength || 1000;
            } else {
                inputElement = document.createElement('input');
                inputElement.className = `field-input ${config.inputClass}`;
                inputElement.type = fieldName === 'website' ? 'url' : 'text';
            }
            
            inputElement.placeholder = config.placeholder;
            inputElement.value = formState[fieldName] || '';
            
            // Position input container to align text exactly with display text
            inputContainer.style.left = x + 'px';
            inputContainer.style.top = y + 'px';
            inputContainer.style.width = '38vw'; // Match mockup proportions
            
            if (config.type === 'textarea') {
                inputContainer.style.height = Math.max(height, 120) + 'px';
            } else {
                inputContainer.style.height = height + 'px';
            }
            
            // Position border around input - FIXED CALCULATION
            const padding = 16; // 1vw converted to pixels approximately
            const inputWidthVw = window.innerWidth * 0.38; // 38vw in pixels
            const borderWidth = inputWidthVw + (padding * 2);
            border.style.left = (x - padding) + 'px';
            border.style.top = (y - padding) + 'px';
            border.style.width = borderWidth + 'px';
            
            if (config.type === 'textarea') {
                border.style.height = (Math.max(height, 120) + padding * 2) + 'px';
            } else {
                border.style.height = (height + padding * 2) + 'px';
            }
            
            // Position label on border
            label.style.left = (x - padding + 12) + 'px';
            label.style.top = (y - padding - 9) + 'px';
            
            // Add character counter for description
            if (fieldName === 'description') {
                const counter = document.createElement('div');
                counter.className = 'character-counter';
                counter.id = `charCounter-${fieldName}`;
                counter.textContent = config.maxLength - (formState[fieldName] || '').length;
                inputContainer.appendChild(counter);
                
                inputElement.addEventListener('input', () => updateCharCounter(fieldName));
            }
            
            // Assemble overlay
            inputContainer.appendChild(inputElement);
            overlay.appendChild(border);
            overlay.appendChild(label);
            overlay.appendChild(inputContainer);
            
            // Add to field
            fieldElement.appendChild(overlay);
            
            // Trigger on next frame - no animations, just show everything
            requestAnimationFrame(() => {
                inputElement.focus();
                if (inputElement.select) inputElement.select();
            });
            
            // Add event listeners
            setupInputEventListeners(inputElement, fieldName);
        }

        function setupInputEventListeners(inputElement, fieldName) {
            inputElement.addEventListener('blur', () => {
                if (activeField === fieldName) {
                    saveField(fieldName);
                }
            });
            
            inputElement.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && fieldName !== 'description') {
                    inputElement.blur();
                } else if (e.key === 'Escape') {
                    cancelEdit(fieldName);
                }
            });
            
            if (fieldName === 'category') {
                inputElement.addEventListener('change', () => {
                    if (activeField === fieldName) {
                        saveField(fieldName);
                    }
                });
            }
        }

        function saveField(fieldName) {
            const overlay = document.getElementById(`overlay-${fieldName}`);
            if (!overlay) return;
            
            const inputElement = overlay.querySelector('input, select, textarea');
            const newValue = inputElement.value;
            
            // Don't allow empty category
            if (fieldName === 'category' && !newValue) {
                inputElement.focus();
                return;
            }
            
            // Update form state
            formState[fieldName] = newValue;
            
            // Update display
            updateFieldDisplay(fieldName, newValue);
            
            // Remove overlay
            removeFieldOverlay(fieldName);
            
            // Show display and edit button
            const displayElement = document.getElementById(`${fieldName}Display`);
            const editButton = document.getElementById(`edit${capitalizeFirst(fieldName)}`);
            displayElement.style.opacity = '1';
            editButton.style.opacity = '1';
            
            activeField = null;
            
            console.log('üìù Updated field:', fieldName, '=', newValue);
        }

        function cancelEdit(fieldName) {
            closeField(fieldName);
            activeField = null;
        }

        function removeFieldOverlay(fieldName) {
            const overlay = document.getElementById(`overlay-${fieldName}`);
            if (overlay) {
                overlay.remove();
            }
        }

        function updateFieldDisplay(fieldName, value) {
            if (fieldName === 'category') {
                // Update the select element instead of display text
                const selectElement = document.getElementById('categorySelect');
                if (selectElement) {
                    selectElement.value = value || '';
                }
                return;
            }
            
            const display = document.getElementById(`${fieldName}Display`);
            if (!display) return; // Safety check
            
            if (fieldName === 'website') {
                // Strip https://, http://, and www. from display
                let cleanUrl = value || '';
                if (cleanUrl) {
                    cleanUrl = cleanUrl.replace(/^https?:\/\//, '').replace(/^www\./, '');
                }
                display.textContent = cleanUrl || 'website (example.com)';
                display.className = cleanUrl ? 'field-display' : 'field-display placeholder';
            } else if (fieldName === 'description') {
                display.textContent = value || 'Give our members an elevator pitch of who you are.';
                display.className = value ? 'field-display' : 'field-display placeholder';
            } else {
                display.textContent = value || 'Company name';
                display.className = value ? 'field-display' : 'field-display placeholder';
            }
        }

        function updateCharCounter(fieldName) {
            const counter = document.getElementById(`charCounter-${fieldName}`);
            const inputElement = document.querySelector(`#overlay-${fieldName} textarea`);
            if (!counter || !inputElement) return;
            
            const config = fieldConfigs[fieldName];
            const remaining = config.maxLength - inputElement.value.length;
            
            counter.textContent = remaining;
            counter.className = remaining <= 75 ? 'character-counter warning' : 'character-counter';
        }

        function capitalizeFirst(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // ===========================================
        // INITIALIZATION
        // ===========================================
        document.addEventListener('DOMContentLoaded', async () => {
            const urlParams = new URLSearchParams(window.location.search);
            
            // Check for OAuth callback success/error
            if (urlParams.get('success') === 'true') {
                console.log('üéâ OAuth callback success!');
                showSuccessState();
                return;
            }
            
            if (urlParams.get('error')) {
                const error = urlParams.get('error');
                console.error('‚ùå OAuth callback error:', error);
                showErrorState(getErrorMessage(error));
                return;
            }
            
            // Normal page load - get token and load vendor data
            const token = urlParams.get('token');
            if (!token) {
                showErrorState('Invalid access link. Please check your email for the correct URL.');
                return;
            }

            try {
                console.log('ü™Ñ Loading vendor data for token:', token);
                await loadVendorData(token);
                showWelcomeScreen();
            } catch (error) {
                console.error('Error loading vendor data:', error);
                showErrorState('Unable to load your profile information. Please try again later.');
            }
        });

        // ===========================================
        // WIZARD NAVIGATION
        // ===========================================
        function startWizard() {
            currentStep = 1;
            showStep(currentStep);
            updateStepNavigation();
        }

        function nextStep() {
            // Save any active field before moving
            if (activeField) {
                saveField(activeField);
            }
            
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
                updateStepNavigation();
                updateMobileProgress();
            }
        }

        function previousStep() {
            // Save any active field before moving
            if (activeField) {
                saveField(activeField);
            }
            
            if (currentStep > 0) {
                currentStep--;
                showStep(currentStep);
                updateStepNavigation();
                updateMobileProgress();
            }
        }

        function showStep(stepNumber) {
            // Hide all content sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => section.classList.remove('active'));

            // Show welcome or specific step
            if (stepNumber === 0) {
                document.getElementById('welcomeSection').classList.add('active');
            } else {
                document.getElementById(`step${stepNumber}Section`).classList.add('active');
            }
        }

        function updateStepNavigation() {
            // Remove active class from all steps
            document.querySelectorAll('.step-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to current step
            if (currentStep > 0) {
                const activeStepItem = document.querySelector(`[data-step="${currentStep - 1}"]`);
                if (activeStepItem) {
                    activeStepItem.classList.add('active');
                }
            }
        }

        function updateMobileProgress() {
            const progressFill = document.querySelector('.mobile-progress-fill');
            const progressPercent = ((currentStep - 1) / (totalSteps - 1)) * 100;
            progressFill.style.width = `${Math.max(0, progressPercent)}%`;
        }

        // ===========================================
        // STATE MANAGEMENT
        // ===========================================
        function showWelcomeScreen() {
            showStep(0);
            hideLoadingState();
            hideErrorState();
            hideSuccessState();
            // Fade in content
            document.getElementById('wizardContent').classList.add('loaded');
        }

        function showLoadingState() {
            document.getElementById('loadingState').style.display = 'block';
            document.getElementById('wizardContent').style.display = 'none';
            hideErrorState();
            hideSuccessState();
        }

        function hideLoadingState() {
            document.getElementById('loadingState').style.display = 'none';
            document.getElementById('wizardContent').style.display = 'flex';
        }

        function showErrorState(message) {
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('errorState').style.display = 'block';
            hideLoadingState();
            hideSuccessState();
        }

        function hideErrorState() {
            document.getElementById('errorState').style.display = 'none';
        }

        function showSuccessState() {
            document.getElementById('successState').style.display = 'block';
            hideLoadingState();
            hideErrorState();
        }

        function hideSuccessState() {
            document.getElementById('successState').style.display = 'none';
        }

        function getErrorMessage(error) {
            switch (error) {
                case 'oauth_denied':
                    return 'Google Drive authorization was denied. Your profile was saved without files.';
                case 'oauth_invalid':
                    return 'Invalid authorization response. Please try again.';
                case 'token_failed':
                    return 'Failed to get authorization token. Please try again.';
                case 'callback_failed':
                    return 'Authorization callback failed. Please try again.';
                default:
                    return 'An error occurred during authorization.';
            }
        }

        // ===========================================
        // DATA LOADING
        // ===========================================
        async function loadVendorData(token) {
            showLoadingState();
            
            try {
                console.log('üì° Fetching vendor profile...');
                const response = await fetch(`${API_BASE}/vendor-profile?token=${token}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                vendorData = await response.json();
                console.log('‚úÖ Vendor data loaded:', vendorData);
                
                populateForm(vendorData);
                await loadOrganizationContacts(token);
                
            } catch (error) {
                console.error('üí• Failed to load vendor data:', error);
                throw error;
            }
        }

        async function loadOrganizationContacts(token) {
            console.log('üë• Loading organization contacts...');
            
            try {
                const response = await fetch(`${API_BASE}/get-organization-contacts?token=${token}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                organizationContacts = data.contacts;
                
                console.log(`‚úÖ Loaded ${organizationContacts.length} contacts for ${data.organizationName}`);
                
            } catch (error) {
                console.error('üí• Error loading contacts:', error);
                // Don't throw - contacts are optional
            }
        }

        function populateForm(data) {
            console.log('üìù Populating form with:', data);
            
            // Update booth info
            document.getElementById('boothNumber').textContent = `Booth ${data.boothNumber}`;
            
            // Populate form state with organization data
            formState.companyName = data.organization?.name || '';
            formState.website = data.organization?.website || '';
            formState.category = data.organization?.primaryCategory || '';
            formState.description = data.organization?.description || '';
            
            // Update displays
            updateFieldDisplay('companyName', formState.companyName);
            updateFieldDisplay('website', formState.website);
            updateFieldDisplay('category', formState.category);
            updateFieldDisplay('description', formState.description);
            
            // Store data for later use in form steps
            window.formData = {
                organization: data.organization,
                boothNumber: data.boothNumber
            };
        }

        // ===========================================
        // UTILITY FUNCTIONS
        // ===========================================
        function handleFileSelect(input, displayElementId) {
            const file = input.files[0];
            const displayElement = document.getElementById(displayElementId);
            
            if (file) {
                displayElement.textContent = `Selected: ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`;
                displayElement.style.color = '#28a745';
            } else {
                displayElement.textContent = '';
            }
        }
    </script>
</body>
</html>
